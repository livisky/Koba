define(function(){!function(){var a={qrcodeDom:$("#qrcode"),webNavDom:$("#web-nav"),webNavListDom:$("#web-nav-list"),headerQrcodeLineDom:$("#header-qrcode-line"),headerQrcodeImgDom:$("#header-qrcode-img"),usernameDom:$("#username"),userExitDom:$("#user-exit"),bindEvent:function(){var a=this;a.webNavDom.on("hover",function(){$(this).toggleClass("nav-btn-hover"),a.webNavListDom.toggle()}),a.qrcodeDom.on("hover",function(){$(this).toggleClass("qrcode-hover"),a.headerQrcodeLineDom.toggle(),a.headerQrcodeImgDom.toggle()}),a.usernameDom.on("hover",function(){$(this).toggleClass("username-hover"),a.userExitDom.toggle();var b=$(this).width()+2*parseInt($("#username").css("padding-left"));a.userExitDom.css({width:b})})},init:function(){this.bindEvent()}};a.init();var b=!0,c={MiniCartList:{status:!0,code:1001,msg:"success",data:{count:"5",total:"800",items:[{id:"1",name:"C2S 多功能互联网摄像机",pic:staticsBase+"/b2c/images/header/goods.png",price:"200",num:"2",info:"",isAdjunct:!1,isGift:!1,hasChild:!1},{id:"2",name:"S1 互联网运动摄像机套装",pic:staticsBase+"/b2c/images/header/goods.png",price:"200",num:"1",info:"S1套装类型：两件套",isAdjunct:!1,isGift:!1,hasChild:!0,chidAttr:"11"},{id:"3",name:"C2S 多功能互联网摄像机",pic:staticsBase+"/b2c/images/header/goods.png",price:"200",num:"1",info:"",isAdjunct:!0,isGift:!1,hasChild:!1,childAttr:"11"},{id:"4",name:"C2S 多功能互联网摄像机",pic:staticsBase+"/b2c/images/header/goods.png",price:"0",num:"1",info:"",isAdjunct:!1,isGift:!0,hasChild:!1,childAttr:"11"},{id:"5",name:"c2s MINI",pic:staticsBase+"/b2c/images/header/goods.png",price:"200",num:"2",info:"mini",isAdjunct:!1,isGift:!1,hasChild:!1}]}}},d=2,e={init:function(){var a=this.cart=$(".minicart");if(a)return this.minicartcont=a.find(".minicart-cont"),this.detailbox=a.find(".miniCarDetail"),this.handle=a.find(".ibutton"),this.cartCnt=a.find(".ibutton").find(".minicart-title"),this.bindEvent(),this},bindEvent:function(){var a=this;this.handle.hover(function(){"visible"!=a.minicartcont.css("visibility")&&(a.showLoading(),a.showMiniCartList(),h.getMiniCartList(function(b){a.updateCartList(b)}))},function(){}),this.minicartcont.on("mouseout",function(){a.hideMiniCartList()})},showLoading:function(){this.detailbox.empty().html('<div class="loading">加载中...</div>')},showMiniCartList:function(){this.minicartcont.css({visibility:"visible"}),this.cart.addClass("current")},hideMiniCartList:function(){this.minicartcont.css({visibility:"hidden"}),this.cart.removeClass("current")},updateCartList:function(a){d=a.count,this.cartCnt&&this.cartCnt.html("("+d+")"),d&&"0"!==d?this.cart.addClass("has-pro"):this.cart.removeClass("has-pro"),this.renderCartList(a)},renderCartList:function(a){var b=this,c=a.items;if(b.detailbox.empty(),c&&c.length<=0)return void b.detailbox.html('<div class="cart-empty">购物车中还没有商品，快去选购吧！</div>');for(var d=$("<div>").attr({id:"goodsList"}).addClass("clearfix"),e=0;item=c[e];e++)item.tmp_isAdjunct=item.isAdjunct?"minicart-adjunct":"",item.tmp_isGift=item.isGift?"minicart-gift":"",item.tmp_hasChild=item.hasChild?"hasChild":"",item.tmp_childAttr=item.isGift||item.isAdjunct?item.childAttr:"",item.tmp_data_child_attr=item.hasChild?'data_child_attr="'+item.chidAttr+'"':"",el=$(this.renderTmp(item,f)),el.find(".delcart").on("click",function(a){b.removeCartEvent(b,this),a.stop()}),d.append(el);b.detailbox.append(d),b.detailbox.append($(this.renderTmp(a,g)))},removeCartEvent:function(a,b){var c=a,d=$($(b).parents(".minicart-single"));h.removeCart(d.attr("id"),function(a){c.updateCartList(a)})},renderTmp:function(a,b){return b.replace(/\{.+?\}/g,function(b){return a[b.slice(1,-1)]})}},f=['<div id="{id}" class="minicart-single {tmp_isAdjunct} {tmp_isGift} {tmp_hasChild} {tmp_childAttr} clearboth clearfix" {tmp_data_child_attr}>','<div class="promotionsBg"></div>','<div class="goodpic">','<img src="{pic}">',"</div>",'<div class="goods-main">','<div class="goodinfo">','<h3><a href="" class="nc-name">{name}</a></h3>',"<span>{info}</span>","</div>",'<div class="price-wrap">','<p class="sum-n-del">','<span class="pro-price">{price}</span>','<span class="pro-gift">赠品</span>','<span class="pro-num">×&nbsp;{num}</span>','<span class="pro-del"><a href="#" class="delcart">删除</a></span>',"</p>","</div>","</div>","</div>"].join(""),g=['<div class="cartInfoItems">','<div class="clearfix sum-n-go textright">','<h4 class="micolor1 clearfix">','<p class="cart-account">总计：','<span class="subtotal micolor2">{total}</span>',"</p>",'<p class="cart-count">共&nbsp;<span class="item_quantity">{count}</span>&nbsp;件商品</p>',"</h4>",'<div class="clearfix">','<a href="" class="go-cart">去购物车结算</a>',"</div>","</div>","</div>"].join("");e.init();var h={getMiniCartList:function(a){b?a(c.MiniCartList.data):$.ajax({url:"",type:"GET",data:{param1:"value1"},success:function(b){rs.status&&a(b.data)},fail:function(){}})},removeCart:function(a,d){if(b){var e="";$("#"+a).hasClass("hasChild")&&(e=$("#"+a).attr("data_child_attr"));for(var f,g=c.MiniCartList.data.items.length,h=0;g>h;h++)f=c.MiniCartList.data.items.shift(),f.id==a||e&&f.childAttr==e?(c.MiniCartList.data.count=c.MiniCartList.data.count-1,c.MiniCartList.data.total=c.MiniCartList.data.total-200):c.MiniCartList.data.items.push(f);d(c.MiniCartList.data)}else $.ajax({url:"",type:"get",data:{id:a},success:function(a){a.status&&d(a.data)}})}}}()});